# .agent-instructions.md

## Project Name: Tandem (Restaurant Chatbot SaaS)
You are the AI assistant for the Tandem monorepo. Your job is to understand and maintain the architecture, make targeted and precise code changes when asked, and avoid large rewrites unless explicitly instructed.

## Purpose of the Project
Tandem is a multi-tenant SaaS platform for restaurants. It provides:
- A live AI-powered chatbot for menu questions, FAQs, and reservation handling.
- A public-facing client widget (Next.js).
- An admin dashboard for restaurant management (Next.js).
- A backend API for OpenAI, Supabase, and reservation logic (Express).
The system is designed to scale to many restaurants.

## Monorepo Structure
tandem/
  apps/
    admin/   → Next.js 16 admin dashboard
    client/  → Next.js 16 public chatbot widget
  packages/
    api/     → Express server for OpenAI logic, Supabase access, reservation engine
    ui/      → Shared UI components
  .devcontainer/
  .github/workflows/
  README.md
  package.json

## Technologies
- Next.js 16 for admin and client.
- Node 20+ only.
- Express for server logic.
- Supabase as the database.
- OpenAI for conversational responses.
- Devcontainer for consistent development.
- GitHub Actions for CI.

## Environment Variables
Each app has a .env.example file. Never commit real .env files. For the API, required fields include:
OPENAI_API_KEY=
SUPABASE_URL=
SUPABASE_SERVICE_ROLE_KEY=
SUPABASE_ANON_KEY=
OPENAI_MODEL=gpt-4o-mini

## Running the System Inside the Devcontainer
Ports:
- Admin: 3000
- Client: 3001
- API: 4000

Start everything at once:
npm run dev

Or individually:
npm run dev:admin
npm run dev:client
npm run dev:api

## Agent Behavior Guidelines
1. Respect the monorepo structure. Do not move or rename major folders unless instructed.
2. When editing files, make minimal, targeted changes unless a full rewrite is specifically requested.
3. When adding features, include all necessary components, routes, files, and integration steps.
4. Follow Next.js 16, Express, and Supabase best practices.
5. Never hardcode sensitive data or keys.
6. When interacting with Supabase, use the correct environment variables and avoid leaking keys.
7. When updating code, stay consistent with existing patterns.
8. When updating CI or devcontainer configuration, preserve Node 20+ and do not introduce unnecessary complexity.
9. Always provide file paths, code blocks, and instructions when modifying or adding features.

## Data Model Overview
Supabase tables include:
restaurants (id, name, domain, logo_url, hours_json, etc.)
menu_items (id, restaurant_id, name, description, price, category, image_url)
faqs (id, restaurant_id, question, answer)

## Chatbot Engine Requirements
The backend API must:
- Load restaurant data, menu, FAQs.
- Normalize input.
- Call OpenAI.
- Construct and return structured responses.
- Handle reservation logic.
The agent must not alter this flow without explicit instruction.

## Git Usage Guidelines
When asked to commit:
1. Stage only changed files.
2. Use clear commit messages.
3. Push to main unless told otherwise.
4. Do not rewrite history or create branches unless instructed.

## Error Handling Guidelines
When diagnosing errors:
1. Identify the root cause.
2. Suggest the smallest possible fix.
3. Provide exact file changes.
4. Offer fallback solutions.

## Actions the Agent Must Avoid
- Do not delete or rename major folders without instruction.
- Do not replace entire files unless explicitly asked.
- Do not introduce new frameworks or architecture patterns without approval.
- Do not commit secrets.

## Primary Goal
Maintain a stable, scalable, and reliable codebase while supporting development of the Tandem platform. Be precise, consistent, and avoid unnecessary complexity.

## Maintenance and Updates
The VS Code Agent should keep this instructions file up to date. If the project structure, workflows, technologies, or development patterns undergo significant changes, the agent must update this file to reflect the new reality. If Mike provides instructions that conflict with the contents of this file, the agent should update this file to align with the new direction instead of following outdated guidance. The agent should also proactively suggest updates when it detects changes that require revisions.

[END OF FILE]
